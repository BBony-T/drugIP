<!-- search.html -->
<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>검색 결과</title>
  <style>
    :root{
      /* ✅ 위치 미세조정이 필요하면 여기 숫자만 조금씩 바꾸면 됨 */
      --title-top: 12%;
      --title-left: 19%;
      --title-width: 53%;
      --title-height: 10%;

      --screen-top: 46%;
      --screen-left: 14%;
      --screen-width: 72%;
      --screen-height: 40%;

      --btn-top: 88%;
      --btn-left: 18%;
      --btn-width: 64%;
      --btn-height: 7.5%;
    }

    body{
      margin:0;
      background:#111;
      display:grid;
      place-items:center;
      min-height:100vh;
      font-family: system-ui, -apple-system, "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
    }

    /* ✅ 배경 PNG를 그대로 한 장 깔고, 그 위에 텍스트/버튼만 올리는 방식 */
    .stage{
      width:min(480px, 100vw);
      aspect-ratio: 1 / 1;              /* 너가 준 이미지가 1:1 정사각형이라 안정적 */
      position:relative;
      background-image:url("./bg-search.png");
      background-size:cover;
      background-position:center;
      background-repeat:no-repeat;
      overflow:hidden;
    }

    /* ✅ 상단 작은 박스(검색창) 안에 들어갈 제목 */
    .title{
      position:absolute;
      top:var(--title-top);
      left:var(--title-left);
      width:var(--title-width);
      height:var(--title-height);
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:800;
      font-size: clamp(14px, 3.2vw, 20px);
      color:#111;
      text-align:center;
      padding: 0 8px;
      /* 배경은 이미 PNG에 있으므로 따로 박스 배경 안 깜 */
      pointer-events:none;
      user-select:none;
    }

    /* ✅ 휴대폰 화면(흰 영역) 안쪽에 뜨는 랜덤 문구 */
    .result{
      position:absolute;
      top:var(--screen-top);
      left:var(--screen-left);
      width:var(--screen-width);
      height:var(--screen-height);
      display:flex;
      align-items: center;
      justify-content: center;
      text-aligh: center;
      padding: 18px 16px;
      box-sizing:border-box;
      font-weight:800;
      font-size: clamp(16px, 3.8vw, 22px);
      line-height:1.35;
      color:#111;
      white-space:pre-wrap;
      overflow:hidden;
    }

    /* ✅ 하단: 학생기자용 버튼(항상 보임) */
    .btn{
      position:absolute;
      top:var(--btn-top);
      left:var(--btn-left);
      width:var(--btn-width);
      height:var(--btn-height);
      border:0;
      border-radius:14px;
      font-weight:900;
      font-size: clamp(13px, 3.1vw, 18px);
      cursor:pointer;
      background:#111;
      color:#fff;
      box-shadow: 0 6px 18px rgba(0,0,0,.25);
    }
    .btn:active{ transform: translateY(1px); }
    .btn.done{
      background:#666;
      cursor:default;
      box-shadow:none;
    }

    /* ✅ 학생기자 안내 팝업(간단하게) */
    .modal{
      position:absolute;
      inset:0;
      background: rgba(0,0,0,.45);
      display:none;
      align-items:center;
      justify-content:center;
      padding:16px;
      box-sizing:border-box;
    }
    .modal.on{ display:flex; }

    .sheet{
      width:min(360px, 92vw);
      background:#fff;
      border-radius:16px;
      padding:14px;
      box-sizing:border-box;
      text-align:center;
    }
    .sheet h3{
      margin:0 0 8px;
      font-size:18px;
      font-weight:900;
    }
    .sheet p{
      margin:0 0 12px;
      font-size:14px;
      line-height:1.4;
    }
    .sheet a{
      display:inline-block;
      width:100%;
      padding:12px 10px;
      border-radius:14px;
      background:#111;
      color:#fff;
      text-decoration:none;
      font-weight:900;
    }
    .sheet button{
      margin-top:10px;
      width:100%;
      padding:10px;
      border-radius:14px;
      border:0;
      background:#eee;
      font-weight:800;
      cursor:pointer;
    }
  </style>
</head>
<body>
  <div class="stage" role="img" aria-label="정보검색 화면">
    <div class="title" id="title"></div>
    <div class="result" id="result">로딩 중…</div>

    <button class="btn" id="bonusBtn">추가 검색 인증(학생기자용)</button>

    <!-- 학생기자 인증 안내 -->
    <div class="modal" id="modal">
      <div class="sheet">
        <h3>학생기자 인증</h3>
        <p>
          학생기자 토큰 QR을 찍어 인증해 주세요.<br>
          인증이 완료되면 검색 결과가 1회 더 자동으로 뜹니다.
        </p>
        <!-- 토큰 QR이 여는 페이지와 동일하게 만들어도 되고,
             수업에선 "토큰 QR을 찍기"가 메인이므로 이 링크는 보조용 -->
        <a id="tokenLink" href="./token.html">토큰 인증 페이지 열기</a>
        <button id="closeModal">닫기</button>
      </div>
    </div>
  </div>

<script>
window.addEventListener("DOMContentLoaded", () => {
  const params = new URLSearchParams(location.search);
  const s = Number(params.get("s") || "0");

  const titleEl = document.getElementById("title");
  const resultEl = document.getElementById("result");
  const bonusBtn = document.getElementById("bonusBtn");
  const modal = document.getElementById("modal");
  const closeModal = document.getElementById("closeModal");
  const tokenLink = document.getElementById("tokenLink");

  // ✅ 마지막 방문 검색 URL 저장(토큰 인증 후 돌아오기용)
  localStorage.setItem("last_search_url", location.href);

  // ✅ 제목(검색창 안)
  titleEl.textContent = "검색 결과";

  // ✅ 임시 문장(너가 나중에 문장 넣을 곳)
  const LINES = {
   1: [
      "카페인은 중추신경을 자극해 혈관 수축과 각성에 영향을 줄 수 있다.",
      "편두통은 빛, 소리 같은 자극에 의해 악화되는 경우가 있다.",
      "진통제는 통증 신호를 완화하는 약물이다.",
      "멀미약은 전정기관(평형감각)과 관련된 어지럼과 구역에 작용하는 계열이 있다."
    ],
    2: [
      "어지럼증은 성인의 약 20%가 매년 한 번 이상 경험한다.",
      "기립성 저혈압은 자율신경계 조절 이상과 관련된다. 혈압 보상 기전이 충분하지 않을 때 증상이 나타난다.",
      "기립성 어지럼은 예측이 어렵다."
    ],
    3: [
      "공복 상태는 위산이 직접 위점막을 자극해 속쓰림이 나타날 수 있다.",
      "카페인/에너지음료는 위산 분비를 증가시키며 공복 섭취시 위점막 자극이 커질 수 있다.",
      "위산 역류는 신물이 올라오는 느낌과 연관될 수 있다.",
      "진통제(NSAIDs 일부)는 위점막 자극을 증가시키는 계열이 있다."
    ],
    4: [
      "설사는 장에서 수분 흡수가 줄거나 음식물이 대장을 너무 빠르게 통과할 때 발생할 수 있다.",
      "설사로 인한 복통은 장운동 증가로 동반되는 경우가 많다.",
      "통증을 줄이는 약물은 통증 신호를 완화하지만 장운동 자체에는 영향을 주지 않는다.",
      "설사 증상을 줄이는 약물은 장운동이나 장내환경에 작용한다."
    ],
    5: [
      "장운동 변화는 하복부 불편감이나 통증으로 느껴질 수 있다.",
      "위장관 기능조절제(장운동 조절 계열)는 장의 움직임을 조절하는 방향으로 작용할 수 있다.",
      "진통제는 통증 신호를 줄이지만 장운동 원인 자체를 바꾸지는 않는다.",
      "가스/복부 팽만은 하복부 압통이나 불쾌감과 함께 나타날 수 있다."
    ],
    6: [
      "반복 사용은 관절과 힘줄 주변에 미세 손상을 누적시킬 수 있다.",
      "바르는 파스(국소 소염/진통)는 손상 부위 국소 증상에 작용하는 계열이 있다.",
      "아세트아미노펜은 진통과 해열 계열로 위장관 자극과는 성격이 다르다.",
      "소염진통제(NSAIDs)는 염증 반응을 줄이는 방향으로 작용하는 계열이 있다."
    ],
    7: [
      "염좌는 인대가 늘어나거나 손상된 상태를 말한다.",
      "통증은 손상 부위의 염증 반응과 함께 나타날 수 있다.",
      "아세트아미노펜은 통증 신호를 줄이는 계열이다.",
      "바르는 파스(국소 소염/진통)는 손상 부위 국소 증상에 작용하는 계열이 있다."
    ],
    8: [
      "진통제에는 해열진통제와 소염진통제가 있다. 아세트아미노펜은 해열진통제이고, 이부프로펜과 나프록센은 소염진통제이다.",
      "해열진통제는 복용 후 약 30분부터 효과가 나타나며 2시간 정도 후에 최대 효과에 도달한다.",
      "해열제 복용 후 체온 변화는 보통 1~1.5도 감소 범위에서 나타나는 경우가 있다.",
      "목 통증은 바이러스 감염 외에도 건조한 공기, 후비루, 근육 긴장 등 다양한 원인과 연관될 수 있다."
    ],
    9: [
      "기침은 기도를 보호하기 위한 반사 작용으로 나타난다.",
      "종합감기약은 여러 증상(콧물,기침,통증 등)을 한 번에 완화하도록 성분이 조합된 경우가 있다.",
      "아세트아미노펜은 통증과 발열 축에 작용하는 계열이다."
      "목감기약(인후 증상 완화 계열)은 인후 자극 증상에 초점을 둔 성분 조합이 있다."
    ],
    10: [
      "두드러기는 피부 혈관 반응으로 팽진과 가려움이 나타날 수 있다.",
      "히스타민 분비는 가려움과 두드러기 반응과 연관된다.",
      "항히스타제는 히스타민 작용을 줄이는 방향의 약물 계열이다."
    ],
    11: [
      "부종은 혈관 투과성이 급격히 증가할 때 나타날 수 있다.",
      "점막 부종은 피부 증상과 다른 위험도를 가질 수 있다.",
      "알레르기 반응의 진행속도는 개인과 상황에 따라 달라질 수 있다.",
      "호흡기 관련 부종은 증상 양상이 달라질 수 있다."
    ],
    12: [
      "호흡곤란은 심장·폐 기능 변화와 연관될 수 있다.",
      "흉부 불편감은 산소 교환과 순환 변화 등 다양한 원인에서 공통적으로 나타날 수 있다.",
      "호흡 증상 평가에는 산소포화도, 심전도, 흉부 영상 같은 검사가 사용될 수 있다.",
      "증상만으로 원인 단정은 어렵다."
    ],
    13: [
      "두통에는 생활습관 관리로 완화되는 두통과 즉시 평가가 필요한 두통이 있다.",
      "두통 평가에서 CT·MRI 같은 뇌 영상 검사가 시행되는 경우가 있다.",
      "뇌압 상승은 심한 두통과 구토가 함께 나타나는 양상과 연관될 수 있다.",
      "양상이 다른 두통은 기존 두통과 구분해서 본다."
    ],
    14: [
      "눈에 이물질이 들어가면 눈물 분비가 증가하면서 이물감이 나타날 수 있다.",
      "인공눈물은 눈 표면을 적셔 이물질 배출을 돕는 역할을 한다.",
      "알레르기 반응이 있을 경우 눈 가려움, 충혈이 함께 나타날 수 있다.",
      "눈을 비비는 행동은 각막 표면에 미세 손상을 유발할 수 있다."
    ],
  };

  function drawRandomLine() {
    const list = LINES[s] || ["문장이 아직 등록되지 않았습니다."];
    const idx = Math.floor(Math.random() * list.length);
    resultEl.textContent = list[idx];
  }

  // ✅ 접속 즉시 1줄 자동 출력
  drawRandomLine();

  // ✅ 토큰 인증 성공 후 돌아오면 1줄 추가로 자동 출력 + 버튼 사용완료
  const bonusGranted = localStorage.getItem("bonus_granted") === "1";
  if (bonusGranted) {
    drawRandomLine();
    bonusBtn.textContent = "사용 완료";
    bonusBtn.classList.add("done");
    bonusBtn.disabled = true;
    localStorage.removeItem("bonus_granted");
  }

  // ✅ 학생기자 인증 팝업
  bonusBtn.addEventListener("click", () => {
    modal.classList.add("on");
    tokenLink.href = "./token.html?return=" + encodeURIComponent(location.href);
  });

  closeModal.addEventListener("click", () => modal.classList.remove("on"));
  modal.addEventListener("click", (e) => { if (e.target === modal) modal.classList.remove("on"); });
});
</script>

</body>
</html>




